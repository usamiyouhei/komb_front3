<template>
  <!-- トグルスイッチ -->
  <div class="ToggleSwitch" @click="onClick()">
    <div class="Label mr-1" v-if="label && position !== 'left'">{{ label }}</div>
    <div class="Switch" :class="{ Inset: inset }">
      <div class="Track" :style="{ backgroundColor: input ? useGetThemeColor(color) : '#ccc', opacity: 0.3 }" />
      <div class="Control" :class="{ valueOn: input, valueOff: !input }">
        <div
          class="Inner"
          :style="{
            backgroundColor: input ? useGetThemeColor(color) : '#CCC',
          }"
        />
        <div class="Hover" />
      </div>
    </div>
    <div class="Label ml-1" v-if="label && position === 'left'">{{ label }}</div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, watch, onBeforeMount, onBeforeUnmount } from 'vue'
import { useGetThemeColor } from '../../composables/colors'
//今回printWidthは120にしてるので、この===の長さを目安にコードを整える
/**===================================================================================================================
 * トグルスイッチ
 * VuetifyのSwitchコンポーネントの出来が良いので、そのまま使う?
 * やっぱ、微妙にカスタマイズが出来ないので、作り直すｗ
 * ===================================================================================================================**/

//------------------------------------------------------------------------------------------------------------
// 引数
//------------------------------------------------------------------------------------------------------------
interface Props {
  label?: string
  position?: string
  value?: boolean
  inset?: boolean
  color?: string
}

const props = withDefaults(defineProps<Props>(), {
  color: 'Primary',
  position: 'left',
})

//------------------------------------------------------------------------------------------------------------
// 定数・変数（state）
//------------------------------------------------------------------------------------------------------------
const input = ref(props.value)

//------------------------------------------------------------------------------------------------------------
// ライフサイクル
//------------------------------------------------------------------------------------------------------------
onBeforeMount(() => {})

onMounted(() => {})

onBeforeUnmount(() => {})

//------------------------------------------------------------------------------------------------------------
// ウォッチ
//------------------------------------------------------------------------------------------------------------
watch(
  () => props.value,
  (value) => {
    input.value = value
  }
)

//------------------------------------------------------------------------------------------------------------
// メソッド
//------------------------------------------------------------------------------------------------------------

//------------------------------------------------------------------------------------------------------------
// エミット
// default（v-model）の場合、modelValue
// が色々やるので、別名にする
// :value="hoge" @update.value=(onHoge($event)) みたいにする
//------------------------------------------------------------------------------------------------------------
const emits = defineEmits<{ (e: 'update:value', item: boolean): void }>()

function onClick() {
  input.value = !input.value
  emits('update:value', input.value)
}
</script>

<style scoped>
.ToggleSwitch {
  position: relative;
  cursor: pointer;
  display: flex;
  align-items: center;
}

.Label {
  font-size: 14px;
  white-space: nowrap;
}

.Switch {
  position: relative;
  width: 46px;
  height: 24px;
}

.Track {
  position: absolute;
  top: 5px;
  left: 5px;
  width: 36px;
  height: 14px;
  background-color: #666;
  border-radius: 8px;
  transition: background-color 0.3s ease-out;
}

.Control {
  position: absolute;
  top: 2px;
  left: 2px;
  width: 20px;
  height: 20px;
  border-radius: 10px;
  transition: transform 0.1s ease-in;
}
.Control.valueOn {
  transform: translate(22px, 0);
}
.Control.valueOff {
  transform: translate(0px, 0);
}
.Control .Inner {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 20px;
  height: 20px;
  border-radius: 10px;
  transition: background-color 0.2s ease-out;
}
.Control .Hover {
  transition: opacity 0.2s ease-out;
  position: absolute;
  top: 0px;
  left: 0px;
  width: 20px;
  height: 20px;
  background: #fff;
  border-radius: 10px;
  opacity: 0;
}

.ToggleSwitch:hover .Control .Hover {
  transition: opacity 0.2s ease-out;
  opacity: 0.5;
}
.ToggleSwitch:hover .Switch.Inset .Control .Hover {
  transition: opacity 0.2s ease-out;
  opacity: 0.4;
}

.Switch.Inset .Track {
  top: 2px;
  left: 2px;
  width: 42px;
  height: 20px;
  border-radius: 12px;
}
.Switch.Inset .Control {
  top: 4px;
  left: 4px;
  width: 16px;
  height: 16px;
}
.Switch.Inset .Control.valueOn {
  transform: translate(22px, 0);
}
.Switch.Inset .Control.valueOff {
  transform: translate(0px, 0);
}
.Switch.Inset .Control .Inner {
  width: 16px;
  height: 16px;
  border-radius: 12px;
}
.Switch.Inset .Control .Hover {
  width: 16px;
  height: 16px;
  border-radius: 12px;
  opacity: 0;
}
</style>
