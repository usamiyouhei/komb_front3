<template>
  <div
    class="ButtonIcon"
    :class="{
      light: light,
      disabled: disabled,
      top: position === 'top',
      bottom: position === 'bottom',
      left: position === 'left',
      right: position === 'right',
    }"
  >
    <div
      class="Icon"
      :class="{
        noback: !backcolor,
      }"
      :style="{
        padding: fit ? '0px' : '6px',
      }"
    >
      <div class="Back" :style="{ backgroundColor: backcolor ? useGetThemeColor(backcolor) : undefined }" />
      <v-icon
        :icon="!toggle && iconOff ? iconOff : icon"
        :size="size"
        :color="useGetThemeColor(disabled ? useGetThemeColor(THEME_COLOR.line) : color || setColor())"
        :style="{
          transform: rotation ? `rotate(${rotation})` : undefined,
          transition: 'transform 0.3s ease',
        }"
      />
    </div>
    <div v-if="label" class="Label" :class="{ narrow: narrow }" :style="{ fontWeight: bold ? 'bold' : '' }">
      {{ label }}
    </div>
    <div v-if="hint" class="Help" :class="{ narrow: narrow }">
      <PartsTooltip :text="hint" class="ma-2" :position="POSITION.TOP" :offsetY="-4">
        <v-icon icon="mdi-help-circle" />
      </PartsTooltip>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, watch } from 'vue'
import { isDark, useGetThemeColor } from '../../composables/colors'
import { THEME_COLOR, POSITION } from '../../composables/constants'
const input = ref('')

interface Props {
  icon?: string
  iconOff?: string
  color?: string
  label?: string
  position?: string
  backcolor?: string
  size?: number
  rotation?: string
  light?: boolean
  disabled?: boolean
  bold?: boolean
  narrow?: boolean
  toggle?: boolean
  fit?: boolean
  hint?: string
}

const props = withDefaults(defineProps<Props>(), {
  icon: 'mdi-close',
  size: 20,
  position: 'bottom',
  toggle: true,
})

function setColor() {
  if (isDark()) {
    return '#BBB'
  } else {
    return '#333'
  }
}

//------------------------------------------------------------------------------------------------------------
//watch
//------------------------------------------------------------------------------------------------------------
watch(
  () => props.color,
  (value) => {
    // console.log('è‰²', value)
  }
)
</script>

<style scoped>
.ButtonIcon {
  position: relative;
  display: flex;
  cursor: pointer;
}
.ButtonIcon .Label {
  pointer-events: none;
  white-space: nowrap;
  font-size: 12px;
  line-height: 12px;
}
.ButtonIcon.top {
  flex-direction: column-reverse;
  justify-content: flex-start;
  align-items: center;
}
.ButtonIcon.top .Label {
  margin-bottom: 4px;
}
.ButtonIcon.top .Label.narrow {
  margin-bottom: 0px;
}
.ButtonIcon.bottom {
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
}
.ButtonIcon.bottom .Label {
  margin-top: 4px;
}
.ButtonIcon.bottom .Label.narrow {
  margin-top: 0px;
}
.ButtonIcon.left {
  flex-direction: row-reverse;
  justify-content: flex-start;
  align-items: center;
}
.ButtonIcon.left .Label {
  margin-right: 4px;
  margin-top: 2px;
}
.ButtonIcon.left .Label.narrow {
  margin-right: 0px;
}
.ButtonIcon.right {
  flex-direction: row;
  justify-content: flex-start;
  align-items: center;
}
.ButtonIcon.right .Label {
  margin-left: 4px;
  margin-top: 2px;
}
.ButtonIcon.right .Label.narrow {
  margin-left: 0px;
}
.ButtonIcon .Icon {
  position: relative;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 6px;
  pointer-events: none;
}
.ButtonIcon .Help {
  margin-left: 0px;
}
.ButtonIcon .Back {
  position: absolute;
  border-radius: inherit;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  transition: opacity 0.2s ease-in-out;
}
.ButtonIcon .noback {
  transition: opacity 0.2s ease-in-out;
}
.ButtonIcon .noback .Icon {
  padding: 2px;
}
.ButtonIcon:hover .Back {
  opacity: 0.8;
}
.ButtonIcon:hover .noback {
  opacity: 0.6;
}
.ButtonIcon:active .Back {
  opacity: 0.6;
}
.ButtonIcon:active .noback {
  opacity: 0.4;
}
.ButtonIcon.light .Back {
  opacity: 0;
}
.ButtonIcon.light:hover .Back {
  opacity: 0.2;
}
.ButtonIcon.light:active .Back {
  opacity: 0.3;
}
.ButtonIcon.disabled {
  color: rgba(var(--r-color-color), 0.6) !important;
  cursor: auto;
  pointer-events: none;
}
</style>
