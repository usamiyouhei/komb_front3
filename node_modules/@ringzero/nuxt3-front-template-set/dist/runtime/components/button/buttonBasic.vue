<template>
  <div
    class="ButtonBasic"
    :class="{
      disabled: disabled && buttonType !== 'frame',
      ButtonColor: disabled && buttonType === 'frame',
      light: light,
      outline: border,
    }"
    :style="{
      width: width ? width + 'px' : undefined,
      height: height ? height + 'px' : undefined,
      justifyContent: align,
      alignItems: 'center',
      // color: disabled&&dark?
    }"
  >
    <div
      class="Back"
      :style="{
        backgroundColor:
          backcolor && !disabled
            ? useGetThemeColor(backcolor)
            : light && !disabled
              ? useGetThemeColor(THEME_COLOR.primary)
              : undefined,
      }"
    />
    <div
      v-if="beforIcon"
      class="ButtonIcon before"
      :style="{
        marginTop: iconTop ? iconTop : undefined,
        marginLeft: iconLeft ? iconLeft : undefined,
        marginRight: iconRight ? iconRight : undefined,
        // transition: 'all 0.2s',
      }"
    >
      <v-icon
        :icon="beforIcon"
        :size="iconSize"
        :color="color ? useGetThemeColor(color) : undefined"
        :style="{
          transform: rotation ? `rotate(${rotation})` : undefined,
          color: color ? useGetThemeColor(color) : undefined,
        }"
      />
    </div>
    <div
      v-if="text"
      class="Label"
      :style="{
        color: color ? useGetThemeColor(color) : undefined,
        paddingLeft: beforIcon ? calcIconPadding() : undefined,
        paddingRight: afterIcon ? calcIconPadding() : undefined,
        fontSize: size ? size : undefined,
      }"
    >
      {{ text }}
    </div>
    <div
      v-if="afterIcon"
      class="ButtonIcon after"
      :style="{
        marginTop: iconTop ? iconTop : undefined,
        marginRight: iconLeft ? iconLeft : undefined,
        marginLeft: iconRight ? iconRight : undefined,
        fontSize: size ? size : undefined,
      }"
    >
      <v-icon
        :icon="afterIcon"
        :size="iconSize"
        :color="color ? useGetThemeColor(color) : undefined"
        :style="{
          transform: rotation ? `rotate(${rotation})` : undefined,
          color: color ? useGetThemeColor(color) : undefined,
        }"
      />
    </div>
    <div v-if="hint" class="Help" :class="{ narrow: narrow }">
      <PartsTooltip :text="hint" class="ma-2" :position="POSITION.TOP" :offsetY="-4">
        <v-icon icon="mdi-help-circle" />
      </PartsTooltip>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, watch } from 'vue'
import { THEME_COLOR, POSITION } from '../../composables/constants'
import { useGetThemeColor } from '../../composables/colors'

interface Props {
  text?: string
  align?: string
  height?: number
  width?: number
  size?: string
  beforIcon?: string
  afterIcon?: string
  iconTop?: string
  iconLeft?: string
  iconRight?: string
  iconSize?: number
  rotation?: string
  color?: string
  backcolor?: string
  disabled?: boolean
  border?: boolean
  light?: boolean
  narrow?: boolean
  broad?: boolean
  iconPadding?: string
  buttonType?: string
  medium?: boolean
  hint?: string
}

const props = withDefaults(defineProps<Props>(), {
  align: 'center',
  height: 30,
  round: 0,
  rotatiom: '0',
})

/**
 * Selectメニューのラッパー
 **/
const input = ref('')
const isNarrow = ref(props.narrow)

//------------------------------------------------------------------------------------------------------------
//watch
//------------------------------------------------------------------------------------------------------------
watch(
  () => props.narrow,
  (value) => {
    isNarrow.value = value
  }
)

function calcIconPadding() {
  let result = '0px'
  if (props.iconPadding) {
    result = props.iconPadding
  } else if (props.broad) {
    result = '12px'
  } else if (isNarrow.value) {
    result = '0px'
  } else {
    result = '6px'
  }
  return result
}
</script>
<style scoped>
.ButtonBasic {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  height: 30px;
  transition: background-color 0.2s ease;
  cursor: pointer;
}
.ButtonBasic .Label {
  position: relative;
  margin-top: 1px;
  white-space: nowrap;
}
.ButtonBasic .ButtonIcon {
  position: relative;
  font-size: 18px;
}
.ButtonBasic .Back {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: inherit;
  transition: opacity 0.2s ease-in-out;
}
.ButtonBasic .ButtonColor {
  background: rgb(var(--r-color-disabled));
  opacity: 1;
}
.ButtonBasic.outline {
  border: 1px solid rgb(var(--v-color-line));
}
.ButtonBasic:hover .Back {
  opacity: 0.8;
}
.ButtonBasic:active .Back {
  opacity: 0.6;
}
.ButtonBasic.light .Back {
  opacity: 0;
}
.ButtonBasic.light:hover .Back {
  opacity: 0.1;
}
.ButtonBasic.light:active .Back {
  opacity: 0.2;
}
.ButtonBasic.light.disabled {
  opacity: 1;
}
.ButtonBasic.disabled, .ButtonBasic.disabled.light {
  cursor: auto;
}
.ButtonBasic.disabled .Back, .ButtonBasic.disabled.light .Back {
  background: rgb(var(--r-color-disabled));
  opacity: 1;
}
.ButtonBasic.disabled .Back.outline, .ButtonBasic.disabled.light .Back.outline {
  border: 1px solid rgb(var(--r-color-disabled));
}
.ButtonBasic.disabled:hover .Back, .ButtonBasic.disabled.light:hover .Back {
  opacity: 1;
}
.ButtonBasic.disabled:active .Back, .ButtonBasic.disabled.light:active .Back {
  opacity: 1;
}
</style>
